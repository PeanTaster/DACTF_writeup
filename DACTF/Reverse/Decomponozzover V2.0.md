# Decomponozzover

## Описание

Ага, читеришь?


[dinozover_patched.rar](../../_resources/dinozover_patched.rar)


## Решение

Тут уже не прокатаят старые методы, потому что здесь просто нельзя выиграть. Тогда начинаем думать. 

Получаем на вход бинарь. Можно его закинуть в иду, чекнуть строки и увидеть упоминание Python. Делаем вывод, что это просто упакованый Python.

Упакованный код реверсить бессмысленно. Так что попробуем снять пакер.

Для этого используем `pyinstxtractor`

Команда: `python3 ./pyinstxtractor.py ./dist/chromedino.exe`

![bc6f5457384a5a4dd8dbe3dcfff03c77.png](../../_resources/bc6f5457384a5a4dd8dbe3dcfff03c77.png)

Окей, нас есть распакованный код. 

![5dfbce3c8fbd59b7b91ae869f5ca153c.png](../../_resources/5dfbce3c8fbd59b7b91ae869f5ca153c.png)

Отсюда нас интересует скомпилированный байткод, который называется `chromedino.pyc`

Если мы попытаемся использовать uncompyle6, то столкнемся с ошибкой. Это потому, что код скомпилирован на Python3.10, который еще не поддерживается этой программой. 

![1da06918cd9b0b0c39f3753a3ab00dc9.png](../../_resources/1da06918cd9b0b0c39f3753a3ab00dc9.png)

Окей, гуглим дальше, натыкаемся на менее популярный инструмент - `pycdc`. 

Попробуем использовать его для декомпиляции. Соберем его и натравим на файл.

![2699dad87943340894dc9b39e2b2b5e2.png](../../_resources/2699dad87943340894dc9b39e2b2b5e2.png)

Эта утилита уже показывает несколько строк декомпилированного кода. Но этого все равно не достаточно.

Тогда используем другой инструмент, который позвоит нам залезть в недра байткода - `pycdas`, который собирается вместе с `pycdc`.

Уже лучше, видим упоминания флага. 

![20a64bb4ccdcc1d850e9272ae5dbfc0d.png](../../_resources/20a64bb4ccdcc1d850e9272ae5dbfc0d.png)

Так, листаем дальше и натыкаемся на объект, который является функцией получения флага. Начинаем читать и восстанавливать логику кода. 

![dc24f6772ee97dd87602662d6f145542.png](../../_resources/dc24f6772ee97dd87602662d6f145542.png)

Видно, что у нас есть обращение к пастбину, криптованая строка, которые являются зашифрованным флагом и ключом, соответственно. Также видим, что возвращаемая переменная имеет название `f1a6`. Круть! 

Также в коде палится то, что используется функция `decrypt из cryptocode`

Супер! Есть все , что нужно! Можем декриптить флаг. 

![f45d09d3b8790091949d07ea82758485.png](../../_resources/f45d09d3b8790091949d07ea82758485.png)

## Ответ
`narfuctf{virastesh_bolshim_reverserom}`